{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport VideoPlayer from './components/VideoPlayer.vue';\nimport addOrEdit from \"./components/AddOrEdit\";\nimport { monitorList, deleteByIds } from \"@/api/modules/monitor\";\nimport { dictypeList } from \"@/api/modules/dictype\";\nimport { dicPage } from \"@/api/modules/dic\";\nexport default {\n  components: {\n    VideoPlayer,\n    addOrEdit\n  },\n  data() {\n    return {\n      visible: false,\n      obj: {},\n      lan2: 8,\n      lan: [{\n        value: 6,\n        label: '四'\n      }, {\n        value: 8,\n        label: '三'\n      }, {\n        value: 12,\n        label: '二'\n      }],\n      videos: [],\n      page: 1,\n      loading: false,\n      form: {\n        name: \"\",\n        address: \"\"\n      },\n      options: [],\n      searchForm: {\n        pageNum: 1,\n        pageSize: 10,\n        dictypeId: \"\"\n      }\n    };\n  },\n  mounted() {\n    this.loadOptions();\n    this.fetchVideos();\n  },\n  methods: {\n    loadOptions() {\n      dictypeList({\n        name: \"地区\"\n      }).then(result => {\n        this.searchForm.dictypeId = result.data[0].id;\n        dicPage({\n          ...this.searchForm\n        }).then(result => {\n          console.log(result.data.records);\n          this.options = result.data.records;\n          this.options.push({\n            label: \"全部\",\n            name: \"全部\",\n            value: \"\"\n          });\n        }).catch(err => {\n          console.log(\"error:\" + err);\n        });\n      }).catch(err => {\n        console.log(\"error:\" + err);\n      });\n    },\n    search() {\n      console.log(this.form.name);\n      this.fetchVideos();\n    },\n    deleteMonitor(ids) {\n      deleteByIds({\n        ids: ids\n      }).then(result => {\n        this.fetchVideos();\n      }).catch(err => {\n        console.log(\"error:\" + err);\n      });\n    },\n    addMonitor() {\n      this.title = \"添加新监控\";\n      this.visible = true;\n      this.obj = {};\n    },\n    editMonitor(row) {\n      this.obj = row;\n      this.title = \"编辑监控\";\n      this.visible = true;\n    },\n    closeFather(val) {\n      this.visible = false;\n      if (val) {\n        this.fetchVideos();\n      }\n    },\n    fetchVideos() {\n      // 从后端获取视频数据，这里只是示例，实际情况需要根据后端API进行调整\n      this.loading = true;\n      monitorList({\n        ...this.form\n      }).then(result => {\n        this.videos = result.data;\n        console.log(this.videos);\n      }).catch(err => {\n        console.log(\"error:\" + err);\n      });\n      // this.videos.push(...this.generateFakeVideos(1));\n      this.page++;\n      this.loading = false;\n    },\n    onScroll() {\n      if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {\n        if (this.loading) return;\n        this.fetchVideos();\n      }\n    }\n  },\n  created() {\n    window.addEventListener('scroll', this.onScroll);\n  },\n  beforeDestroy() {\n    window.removeEventListener('scroll', this.onScroll);\n  }\n};","map":{"version":3,"names":["VideoPlayer","addOrEdit","monitorList","deleteByIds","dictypeList","dicPage","components","data","visible","obj","lan2","lan","value","label","videos","page","loading","form","name","address","options","searchForm","pageNum","pageSize","dictypeId","mounted","loadOptions","fetchVideos","methods","then","result","id","console","log","records","push","catch","err","search","deleteMonitor","ids","addMonitor","title","editMonitor","row","closeFather","val","onScroll","window","innerHeight","scrollY","document","body","offsetHeight","created","addEventListener","beforeDestroy","removeEventListener"],"sources":["src/views/monitor/index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"3\">\r\n        <!-- 新增按钮 -->\r\n        <el-button type=\"primary\" @click=\"addMonitor\">新增</el-button>\r\n        <!-- <video width=\"320\" height=\"240\" controls>\r\n          <source src=\"@/assets/test.mp4\">\r\n        </video> -->\r\n      </el-col>\r\n      <el-col :span=\"3\">\r\n        <el-select v-model=\"lan2\" placeholder=\"请选择\">\r\n          <el-option v-for=\"item in lan\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n          </el-option>\r\n        </el-select>\r\n      </el-col>\r\n      <el-form :model=\"form\" ref=\"form\">\r\n        <el-col :xl=\"6\" :md=\"8\" :sm=\"24\" style=\"margin-bottom: 20px;\">\r\n          <el-input placeholder=\"名字\" v-model=\"form.name\" clearable> </el-input>\r\n        </el-col>\r\n        <el-col :xl=\"6 || 24\" :md=\"6\" :sm=\"24\" style=\"margin-right: 15px\">\r\n          <el-button icon=\"el-icon-search\" type=\"primary\" style=\"margin-left: 15px;\" @click=\"search\">搜索</el-button>\r\n        </el-col>\r\n\r\n        <el-col :span=\"3\">\r\n          <el-select @change=\"fetchVideos()\" v-model=\"form.address\" placeholder=\"请选择\">\r\n            <el-option v-for=\"item in options\" :key=\"item.value\" :label=\"item.name\" :value=\"item.value\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-col>\r\n\r\n      </el-form>\r\n    </el-row>\r\n\r\n    <el-row :gutter=\"24\">\r\n\r\n      <el-col :span=lan2 v-for=\"video in videos\" :key=\"video.id\" style=\"text-align: center;margin-bottom: 20px;\">\r\n        <video-player :video=\"video\" />\r\n        <h2>{{ video.name }}<el-button type=\"primary\" @click=\"editMonitor(video)\" style=\"float: right;\">编辑</el-button>\r\n        </h2>\r\n        <!-- <el-button type=\"danger\" @click=\"deleteMonitor(video.id)\">删除</el-button> -->\r\n      </el-col>\r\n    </el-row>\r\n    <addOrEdit v-if=\"visible\" :defaultFormDate=\"obj\" :title=\"title\" :visible=\"visible\" @close=\"closeFather\"></addOrEdit>\r\n  </div>\r\n</template>\r\n  \r\n<script>\r\nimport VideoPlayer from './components/VideoPlayer.vue';\r\nimport addOrEdit from \"./components/AddOrEdit\"\r\nimport { monitorList, deleteByIds } from \"@/api/modules/monitor\"\r\nimport { dictypeList } from \"@/api/modules/dictype\"\r\nimport { dicPage } from \"@/api/modules/dic\"\r\nexport default {\r\n  components: {\r\n    VideoPlayer,\r\n    addOrEdit\r\n  },\r\n  data() {\r\n    return {\r\n      visible: false,\r\n      obj: {},\r\n      lan2: 8,\r\n      lan: [\r\n        {\r\n          value: 6,\r\n          label: '四'\r\n        }, {\r\n          value: 8,\r\n          label: '三'\r\n        }, {\r\n          value: 12,\r\n          label: '二'\r\n        },\r\n      ],\r\n      videos: [],\r\n      page: 1,\r\n      loading: false,\r\n\r\n      form: {\r\n        name: \"\",\r\n        address: \"\"\r\n      },\r\n      options: [],\r\n      searchForm: {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        dictypeId: \"\",\r\n      },\r\n    };\r\n  },\r\n  mounted() {\r\n    this.loadOptions();\r\n    this.fetchVideos();\r\n  },\r\n  methods: {\r\n    loadOptions() {\r\n      dictypeList({ name: \"地区\" }).then(result => {\r\n        this.searchForm.dictypeId = result.data[0].id;\r\n        dicPage({\r\n          ...this.searchForm\r\n        }).then(result => {\r\n          console.log(result.data.records)\r\n          this.options = result.data.records;\r\n          this.options.push({\r\n            label: \"全部\",\r\n            name: \"全部\",\r\n            value: \"\",\r\n          });\r\n        }).catch(err => {\r\n          console.log(\"error:\" + err)\r\n        })\r\n\r\n      }).catch(err => {\r\n        console.log(\"error:\" + err)\r\n      })\r\n    },\r\n\r\n    search() {\r\n      console.log(this.form.name)\r\n      this.fetchVideos();\r\n    },\r\n    deleteMonitor(ids) {\r\n      deleteByIds({ ids: ids }).then(result => {\r\n        this.fetchVideos();\r\n      }).catch(err => {\r\n        console.log(\"error:\" + err)\r\n      })\r\n    },\r\n    addMonitor() {\r\n      this.title = \"添加新监控\"\r\n      this.visible = true;\r\n      this.obj = {};\r\n    },\r\n    editMonitor(row) {\r\n      this.obj = row;\r\n      this.title = \"编辑监控\"\r\n      this.visible = true;\r\n    },\r\n\r\n    closeFather(val) {\r\n      this.visible = false\r\n      if (val) {\r\n        this.fetchVideos();\r\n      }\r\n    },\r\n\r\n    fetchVideos() {\r\n      // 从后端获取视频数据，这里只是示例，实际情况需要根据后端API进行调整\r\n      this.loading = true;\r\n\r\n      monitorList({ ...this.form }).then(result => {\r\n        this.videos = result.data;\r\n        console.log(this.videos)\r\n      }).catch(err => {\r\n        console.log(\"error:\" + err)\r\n      })\r\n      // this.videos.push(...this.generateFakeVideos(1));\r\n      this.page++;\r\n      this.loading = false;\r\n\r\n    },\r\n\r\n    onScroll() {\r\n      if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {\r\n        if (this.loading) return;\r\n        this.fetchVideos();\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    window.addEventListener('scroll', this.onScroll);\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener('scroll', this.onScroll);\r\n  },\r\n};\r\n</script>\r\n  \r\n<style>\r\n/* 根据需要添加样式 */\r\n</style>"],"mappings":";AAgDA,OAAAA,WAAA;AACA,OAAAC,SAAA;AACA,SAAAC,WAAA,EAAAC,WAAA;AACA,SAAAC,WAAA;AACA,SAAAC,OAAA;AACA;EACAC,UAAA;IACAN,WAAA;IACAC;EACA;EACAM,KAAA;IACA;MACAC,OAAA;MACAC,GAAA;MACAC,IAAA;MACAC,GAAA,GACA;QACAC,KAAA;QACAC,KAAA;MACA;QACAD,KAAA;QACAC,KAAA;MACA;QACAD,KAAA;QACAC,KAAA;MACA,EACA;MACAC,MAAA;MACAC,IAAA;MACAC,OAAA;MAEAC,IAAA;QACAC,IAAA;QACAC,OAAA;MACA;MACAC,OAAA;MACAC,UAAA;QACAC,OAAA;QACAC,QAAA;QACAC,SAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,WAAA;IACA,KAAAC,WAAA;EACA;EACAC,OAAA;IACAF,YAAA;MACAtB,WAAA;QAAAc,IAAA;MAAA,GAAAW,IAAA,CAAAC,MAAA;QACA,KAAAT,UAAA,CAAAG,SAAA,GAAAM,MAAA,CAAAvB,IAAA,IAAAwB,EAAA;QACA1B,OAAA;UACA,QAAAgB;QACA,GAAAQ,IAAA,CAAAC,MAAA;UACAE,OAAA,CAAAC,GAAA,CAAAH,MAAA,CAAAvB,IAAA,CAAA2B,OAAA;UACA,KAAAd,OAAA,GAAAU,MAAA,CAAAvB,IAAA,CAAA2B,OAAA;UACA,KAAAd,OAAA,CAAAe,IAAA;YACAtB,KAAA;YACAK,IAAA;YACAN,KAAA;UACA;QACA,GAAAwB,KAAA,CAAAC,GAAA;UACAL,OAAA,CAAAC,GAAA,YAAAI,GAAA;QACA;MAEA,GAAAD,KAAA,CAAAC,GAAA;QACAL,OAAA,CAAAC,GAAA,YAAAI,GAAA;MACA;IACA;IAEAC,OAAA;MACAN,OAAA,CAAAC,GAAA,MAAAhB,IAAA,CAAAC,IAAA;MACA,KAAAS,WAAA;IACA;IACAY,cAAAC,GAAA;MACArC,WAAA;QAAAqC,GAAA,EAAAA;MAAA,GAAAX,IAAA,CAAAC,MAAA;QACA,KAAAH,WAAA;MACA,GAAAS,KAAA,CAAAC,GAAA;QACAL,OAAA,CAAAC,GAAA,YAAAI,GAAA;MACA;IACA;IACAI,WAAA;MACA,KAAAC,KAAA;MACA,KAAAlC,OAAA;MACA,KAAAC,GAAA;IACA;IACAkC,YAAAC,GAAA;MACA,KAAAnC,GAAA,GAAAmC,GAAA;MACA,KAAAF,KAAA;MACA,KAAAlC,OAAA;IACA;IAEAqC,YAAAC,GAAA;MACA,KAAAtC,OAAA;MACA,IAAAsC,GAAA;QACA,KAAAnB,WAAA;MACA;IACA;IAEAA,YAAA;MACA;MACA,KAAAX,OAAA;MAEAd,WAAA;QAAA,QAAAe;MAAA,GAAAY,IAAA,CAAAC,MAAA;QACA,KAAAhB,MAAA,GAAAgB,MAAA,CAAAvB,IAAA;QACAyB,OAAA,CAAAC,GAAA,MAAAnB,MAAA;MACA,GAAAsB,KAAA,CAAAC,GAAA;QACAL,OAAA,CAAAC,GAAA,YAAAI,GAAA;MACA;MACA;MACA,KAAAtB,IAAA;MACA,KAAAC,OAAA;IAEA;IAEA+B,SAAA;MACA,IAAAC,MAAA,CAAAC,WAAA,GAAAD,MAAA,CAAAE,OAAA,IAAAC,QAAA,CAAAC,IAAA,CAAAC,YAAA;QACA,SAAArC,OAAA;QACA,KAAAW,WAAA;MACA;IACA;EACA;EACA2B,QAAA;IACAN,MAAA,CAAAO,gBAAA,gBAAAR,QAAA;EACA;EACAS,cAAA;IACAR,MAAA,CAAAS,mBAAA,gBAAAV,QAAA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}