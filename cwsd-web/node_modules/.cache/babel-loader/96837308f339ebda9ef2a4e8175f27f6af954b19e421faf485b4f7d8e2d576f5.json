{"ast":null,"code":"import { save, deleteByIds } from \"@/api/modules/equipment\";\nimport { dictypeList } from \"@/api/modules/dictype\";\nimport { dicPage } from \"@/api/modules/dic\";\nexport default {\n  name: \"addOrEdit\",\n  props: {\n    visible: {\n      type: Boolean,\n      default: false\n    },\n    title: {\n      type: String,\n      default: \"新增\"\n    },\n    defaultFormDate: {\n      type: Object\n    }\n  },\n  data() {\n    return {\n      t: 0,\n      flag: false,\n      form: {\n        id: '',\n        name: '',\n        address: '',\n        streamUrl: '',\n        cordon: 0,\n        start: 0,\n        end: 0,\n        flats: ''\n      },\n      options: [],\n      //value,lable\n      searchForm: {\n        pageNum: 1,\n        pageSize: 10,\n        dictypeId: \"\"\n      },\n      fieldRules: {\n        name: [{\n          required: true,\n          message: '请输入名字',\n          trigger: 'blur'\n        }],\n        address: [{\n          required: true,\n          message: '请选择地区',\n          trigger: 'blur'\n        }],\n        flats: [{\n          required: true,\n          message: '请设置单位',\n          trigger: 'blur'\n        }],\n        streamUrl: [{\n          required: true,\n          message: '请设置地址',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  mounted() {\n    this.loadOptions();\n    if (JSON.stringify(this.defaultFormDate) == \"{}\") {\n      this.flag = false;\n    } else {\n      this.form = JSON.parse(JSON.stringify(this.defaultFormDate));\n      this.flag = true;\n    }\n    console.log(this.flag);\n  },\n  methods: {\n    deleteMonitor(ids) {\n      deleteByIds({\n        ids: ids\n      }).then(result => {\n        this.$emit(\"close\", this.flag);\n        this.$message.success(\"成功删除设备\");\n      }).catch(err => {\n        console.log(\"error:\" + err);\n      });\n    },\n    loadOptions() {\n      dictypeList({\n        name: \"地区\"\n      }).then(result => {\n        this.searchForm.dictypeId = result.data[0].id;\n        dicPage({\n          ...this.searchForm\n        }).then(result => {\n          console.log(result.data.records);\n          this.options = result.data.records;\n\n          // this.total = result.data.total;\n          // this.tableData = result.data.records;\n          //this.total = result.data.total\n        }).catch(err => {\n          console.log(\"error:\" + err);\n        });\n      }).catch(err => {\n        console.log(\"error:\" + err);\n      });\n    },\n    close() {\n      this.flag = false;\n      this.$emit(\"close\", this.flag);\n    },\n    submit() {\n      if (this.form.name == \"\" || this.form.address == \"\" || this.form.flats == \"\" || this.form.streamUrl == \"\") {\n        this.$message.error(\"请填写相关内容\");\n      } else {\n        save({\n          ...this.form\n        }).then(res => {\n          this.flag = true;\n          this.$message.success(\"成功\" + this.title);\n          this.$emit(\"close\", this.flag);\n        }).catch(err => {\n          this.flag = false;\n          this.$emit(\"close\", this.flag);\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["save","deleteByIds","dictypeList","dicPage","name","props","visible","type","Boolean","default","title","String","defaultFormDate","Object","data","t","flag","form","id","address","streamUrl","cordon","start","end","flats","options","searchForm","pageNum","pageSize","dictypeId","fieldRules","required","message","trigger","mounted","loadOptions","JSON","stringify","parse","console","log","methods","deleteMonitor","ids","then","result","$emit","$message","success","catch","err","records","close","submit","error","res"],"sources":["src/views/dashboard/components/AddOrEdit.vue"],"sourcesContent":["<template>\r\n  <el-dialog :title=\"title\" :visible=\"visible\" :before-close=\"close\" append-to-body>\r\n    <el-form :model=\"form\" ref=\"form\" :rules=\"fieldRules\">\r\n      <el-form-item label=\"名字\" prop=\"name\">\r\n        <el-input v-model=\"form.name\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"地区\" prop=\"address\">\r\n        <el-select v-model=\"form.address\" placeholder=\"请选择\">\r\n          <el-option v-for=\"item in options\" :key=\"item.value\" :label=\"item.name\" :value=\"item.value\">\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"设备地址\" prop=\"streamUrl\">\r\n        <el-input v-model=\"form.streamUrl\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"单位\" prop=\"flats\">\r\n        <el-input v-model=\"form.flats\" autocomplete=\"off\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"警戒线\" prop=\"cordon\">\r\n        <el-input-number v-model=\"form.cordon\" label=\"描述文字\"></el-input-number>\r\n      </el-form-item>\r\n      <el-form-item label=\"起始\">\r\n        <el-input-number v-model=\"form.start\" label=\"描述文字\"></el-input-number>\r\n      </el-form-item>\r\n      <el-form-item label=\"终止\">\r\n        <el-input-number v-model=\"form.end\" label=\"描述文字\"></el-input-number>\r\n      </el-form-item>\r\n\r\n    </el-form>\r\n    <div slot=\"footer\" class=\"dialog-footer\">\r\n\r\n      <el-button type=\"danger\" @click=\"deleteMonitor(form.id)\" v-if=\"this.flag === true\">删除</el-button>\r\n      <el-button @click=\"close\">取 消</el-button>\r\n      <el-button type=\"primary\" @click=\"submit\">确 定</el-button>\r\n    </div>\r\n  </el-dialog>\r\n</template>    \r\n\r\n<script>\r\nimport { save, deleteByIds } from \"@/api/modules/equipment\"\r\nimport { dictypeList } from \"@/api/modules/dictype\"\r\nimport { dicPage } from \"@/api/modules/dic\"\r\n\r\n\r\nexport default {\r\n  name: \"addOrEdit\",\r\n  props: {\r\n    visible: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    title: {\r\n      type: String,\r\n      default: \"新增\"\r\n    },\r\n    defaultFormDate: {\r\n      type: Object,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      t: 0,\r\n      flag: false,\r\n      form: {\r\n        id: '',\r\n        name: '',\r\n        address: '',\r\n        streamUrl: '',\r\n        cordon: 0,\r\n        start: 0,\r\n        end: 0,\r\n        flats: '',\r\n      },\r\n      options: [],//value,lable\r\n      searchForm: {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        dictypeId: \"\",\r\n      },\r\n      fieldRules: {\r\n        name: [\r\n          { required: true, message: '请输入名字', trigger: 'blur' },\r\n        ],\r\n        address: [\r\n          { required: true, message: '请选择地区', trigger: 'blur' },\r\n        ],\r\n        flats: [\r\n          { required: true, message: '请设置单位', trigger: 'blur' },\r\n        ],\r\n        streamUrl: [\r\n          { required: true, message: '请设置地址', trigger: 'blur' },\r\n        ]\r\n      },\r\n    };\r\n  },\r\n  mounted() {\r\n\r\n    this.loadOptions();\r\n    if (JSON.stringify(this.defaultFormDate) == \"{}\") {\r\n      this.flag = false\r\n    } else {\r\n      this.form = JSON.parse(JSON.stringify(this.defaultFormDate))\r\n      this.flag = true;\r\n    }\r\n    console.log(this.flag)\r\n\r\n  },\r\n  methods: {\r\n    deleteMonitor(ids) {\r\n      deleteByIds({ ids: ids }).then(result => {\r\n        this.$emit(\"close\", this.flag)\r\n        this.$message.success(\"成功删除设备\")\r\n      }).catch(err => {\r\n        console.log(\"error:\" + err)\r\n      })\r\n    },\r\n\r\n    loadOptions() {\r\n      dictypeList({ name: \"地区\" }).then(result => {\r\n        this.searchForm.dictypeId = result.data[0].id;\r\n        dicPage({\r\n          ...this.searchForm\r\n        }).then(result => {\r\n          console.log(result.data.records)\r\n          this.options = result.data.records;\r\n\r\n          // this.total = result.data.total;\r\n          // this.tableData = result.data.records;\r\n          //this.total = result.data.total\r\n        }).catch(err => {\r\n          console.log(\"error:\" + err)\r\n        })\r\n\r\n      }).catch(err => {\r\n        console.log(\"error:\" + err)\r\n      })\r\n\r\n\r\n    },\r\n    close() {\r\n      this.flag = false;\r\n      this.$emit(\"close\", this.flag)\r\n    },\r\n    submit() {\r\n\r\n      if (this.form.name == \"\" || this.form.address == \"\" || this.form.flats == \"\" || this.form.streamUrl == \"\") {\r\n        this.$message.error(\"请填写相关内容\")\r\n      } else {\r\n        save({ ...this.form }).then(res => {\r\n          this.flag = true\r\n          this.$message.success(\"成功\" + this.title)\r\n          this.$emit(\"close\", this.flag)\r\n        })\r\n          .catch(err => {\r\n            this.flag = false\r\n            this.$emit(\"close\", this.flag)\r\n          })\r\n      }\r\n\r\n    }\r\n  }\r\n};\r\n</script>"],"mappings":"AAuCA,SAAAA,IAAA,EAAAC,WAAA;AACA,SAAAC,WAAA;AACA,SAAAC,OAAA;AAGA;EACAC,IAAA;EACAC,KAAA;IACAC,OAAA;MACAC,IAAA,EAAAC,OAAA;MACAC,OAAA;IACA;IACAC,KAAA;MACAH,IAAA,EAAAI,MAAA;MACAF,OAAA;IACA;IACAG,eAAA;MACAL,IAAA,EAAAM;IACA;EACA;EACAC,KAAA;IACA;MACAC,CAAA;MACAC,IAAA;MACAC,IAAA;QACAC,EAAA;QACAd,IAAA;QACAe,OAAA;QACAC,SAAA;QACAC,MAAA;QACAC,KAAA;QACAC,GAAA;QACAC,KAAA;MACA;MACAC,OAAA;MAAA;MACAC,UAAA;QACAC,OAAA;QACAC,QAAA;QACAC,SAAA;MACA;MACAC,UAAA;QACA1B,IAAA,GACA;UAAA2B,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAd,OAAA,GACA;UAAAY,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAT,KAAA,GACA;UAAAO,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAb,SAAA,GACA;UAAAW,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MAEA;IACA;EACA;EACAC,QAAA;IAEA,KAAAC,WAAA;IACA,IAAAC,IAAA,CAAAC,SAAA,MAAAzB,eAAA;MACA,KAAAI,IAAA;IACA;MACA,KAAAC,IAAA,GAAAmB,IAAA,CAAAE,KAAA,CAAAF,IAAA,CAAAC,SAAA,MAAAzB,eAAA;MACA,KAAAI,IAAA;IACA;IACAuB,OAAA,CAAAC,GAAA,MAAAxB,IAAA;EAEA;EACAyB,OAAA;IACAC,cAAAC,GAAA;MACA1C,WAAA;QAAA0C,GAAA,EAAAA;MAAA,GAAAC,IAAA,CAAAC,MAAA;QACA,KAAAC,KAAA,eAAA9B,IAAA;QACA,KAAA+B,QAAA,CAAAC,OAAA;MACA,GAAAC,KAAA,CAAAC,GAAA;QACAX,OAAA,CAAAC,GAAA,YAAAU,GAAA;MACA;IACA;IAEAf,YAAA;MACAjC,WAAA;QAAAE,IAAA;MAAA,GAAAwC,IAAA,CAAAC,MAAA;QACA,KAAAnB,UAAA,CAAAG,SAAA,GAAAgB,MAAA,CAAA/B,IAAA,IAAAI,EAAA;QACAf,OAAA;UACA,QAAAuB;QACA,GAAAkB,IAAA,CAAAC,MAAA;UACAN,OAAA,CAAAC,GAAA,CAAAK,MAAA,CAAA/B,IAAA,CAAAqC,OAAA;UACA,KAAA1B,OAAA,GAAAoB,MAAA,CAAA/B,IAAA,CAAAqC,OAAA;;UAEA;UACA;UACA;QACA,GAAAF,KAAA,CAAAC,GAAA;UACAX,OAAA,CAAAC,GAAA,YAAAU,GAAA;QACA;MAEA,GAAAD,KAAA,CAAAC,GAAA;QACAX,OAAA,CAAAC,GAAA,YAAAU,GAAA;MACA;IAGA;IACAE,MAAA;MACA,KAAApC,IAAA;MACA,KAAA8B,KAAA,eAAA9B,IAAA;IACA;IACAqC,OAAA;MAEA,SAAApC,IAAA,CAAAb,IAAA,eAAAa,IAAA,CAAAE,OAAA,eAAAF,IAAA,CAAAO,KAAA,eAAAP,IAAA,CAAAG,SAAA;QACA,KAAA2B,QAAA,CAAAO,KAAA;MACA;QACAtD,IAAA;UAAA,QAAAiB;QAAA,GAAA2B,IAAA,CAAAW,GAAA;UACA,KAAAvC,IAAA;UACA,KAAA+B,QAAA,CAAAC,OAAA,aAAAtC,KAAA;UACA,KAAAoC,KAAA,eAAA9B,IAAA;QACA,GACAiC,KAAA,CAAAC,GAAA;UACA,KAAAlC,IAAA;UACA,KAAA8B,KAAA,eAAA9B,IAAA;QACA;MACA;IAEA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}